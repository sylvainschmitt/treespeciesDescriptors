[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Tree Species Descriptors",
    "section": "",
    "text": "Introduction\nRepository to develop descriptors of the environment and performance of tropical tree species in Paracou for the Camille and Sebastien analyses."
  },
  {
    "objectID": "index.html#species",
    "href": "index.html#species",
    "title": "Tree Species Descriptors",
    "section": "Species",
    "text": "Species\n\n\nCode\nspecies &lt;- readxl::read_xlsx(\"data/Species_list.xlsx\")\nkable(species, caption = \"Studied species\")\n\n\n\nStudied species\n\n\nSpecies\n\n\n\n\nBocoa prouacensis\n\n\nChaetocarpus schomburgkianus\n\n\nChrysophyllum sanguinolentum\n\n\nDicorynia guianensis\n\n\nEperua falcata\n\n\nEperua grandiflora\n\n\nEschweilera sagotiana\n\n\nGoupia glabra\n\n\nGustavia hexapetala\n\n\nLecythis persistens subsp. aurantiaca\n\n\nLecythis poiteaui\n\n\nLicania membranacea\n\n\nManilkara bidentata\n\n\nPradosia cochlearia\n\n\nProtium opacum subsp. rabelianum\n\n\nQualea rosea\n\n\nSymphonia sp.1\n\n\nTachigali melinonii\n\n\nVirola michelii"
  },
  {
    "objectID": "index.html#individuals",
    "href": "index.html#individuals",
    "title": "Tree Species Descriptors",
    "section": "Individuals",
    "text": "Individuals\n\n\nCode\nguyafor &lt;- DBI::dbConnect(RSQLite::SQLite(), dbname = \"data/guyafor.sql\")\ntrees &lt;- tbl(guyafor, \"inventory\") %&gt;% \n  filter(Forest == \"Paracou\") %&gt;% \n  filter(paste(Genus, Species) %in% local(species$Species)) %&gt;% \n  collect() %&gt;% \n  mutate(DBH = CircCorr/pi)\nDBI::dbDisconnect(guyafor) ; rm(guyafor)\nvroom::vroom_write(trees, \"data/paracou.tsv\")\n\n\n\n\nCode\nvroom::vroom(\"data/paracou.tsv\", show_col_types = F) %&gt;% \n  group_by(Genus, Species) %&gt;% \n  summarise(N = n()) %&gt;% \n  kable(caption = \"Number of individuals per species\")\n\n\n\nNumber of individuals per species\n\n\nGenus\nSpecies\nN\n\n\n\n\nBocoa\nprouacensis\n30561\n\n\nChaetocarpus\nschomburgkianus\n8729\n\n\nChrysophyllum\nsanguinolentum\n5517\n\n\nDicorynia\nguianensis\n16815\n\n\nEperua\nfalcata\n64077\n\n\nEperua\ngrandiflora\n18242\n\n\nEschweilera\nsagotiana\n82706\n\n\nGoupia\nglabra\n17900\n\n\nGustavia\nhexapetala\n17907\n\n\nLecythis\npersistens subsp. aurantiaca\n97172\n\n\nLecythis\npoiteaui\n7531\n\n\nLicania\nmembranacea\n19342\n\n\nManilkara\nbidentata\n3653\n\n\nPradosia\ncochlearia\n19912\n\n\nProtium\nopacum subsp. rabelianum\n11484\n\n\nQualea\nrosea\n17446\n\n\nSymphonia\nsp.1\n15860\n\n\nTachigali\nmelinonii\n4433\n\n\nVirola\nmichelii\n7415"
  },
  {
    "objectID": "1_env.html#twi-topographic-wetness-index",
    "href": "1_env.html#twi-topographic-wetness-index",
    "title": "1  Environment",
    "section": "TWI: Topographic Wetness Index",
    "text": "TWI: Topographic Wetness Index\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  mutate(species =  paste(Genus, Species)) %&gt;% \n  group_by(Species) %&gt;% \n  ggplot(aes(x = species, y = log(TWI+1))) +\n  geom_boxplot() +\n  coord_flip()"
  },
  {
    "objectID": "1_env.html#hand-height-above-nearest-drainage",
    "href": "1_env.html#hand-height-above-nearest-drainage",
    "title": "1  Environment",
    "section": "HAND: Height Above Nearest Drainage",
    "text": "HAND: Height Above Nearest Drainage\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  mutate(species =  paste(Genus, Species)) %&gt;% \n  ggplot(aes(x = species, y = log(HAND+1))) +\n  geom_boxplot() +\n  coord_flip()"
  },
  {
    "objectID": "1_env.html#hydromorphy",
    "href": "1_env.html#hydromorphy",
    "title": "1  Environment",
    "section": "Hydromorphy",
    "text": "Hydromorphy\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  mutate(species =  paste(Genus, Species)) %&gt;% \n  filter(!is.na(Hydro)) %&gt;% \n  ggplot(aes(x = species, fill = as.factor(Hydro))) +\n  geom_bar(position = \"dodge\") +\n  coord_flip() +\n  scale_fill_discrete(\"Hydromorphy\")"
  },
  {
    "objectID": "1_env.html#water-logging",
    "href": "1_env.html#water-logging",
    "title": "1  Environment",
    "section": "Water logging",
    "text": "Water logging\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  mutate(species =  paste(Genus, Species)) %&gt;% \n  filter(!is.na(LevelWater)) %&gt;% \n  ggplot(aes(x = species, fill = as.factor(LevelWater))) +\n  geom_bar(position = \"dodge\") +\n  coord_flip() +\n  scale_fill_discrete(\"Water\\nlogging\")"
  },
  {
    "objectID": "1_env.html#water-table-depth",
    "href": "1_env.html#water-table-depth",
    "title": "1  Environment",
    "section": "Water table depth",
    "text": "Water table depth\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  mutate(species =  paste(Genus, Species)) %&gt;% \n  filter(!is.na(TypeWatEN)) %&gt;% \n  ggplot(aes(x = species, fill = as.factor(TypeWatEN))) +\n  geom_bar(position = \"dodge\") +\n  coord_flip() +\n  scale_fill_discrete(\"\") +\n  guides(fill=guide_legend(nrow=3)) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "1_env.html#drainage-type",
    "href": "1_env.html#drainage-type",
    "title": "1  Environment",
    "section": "Drainage type",
    "text": "Drainage type\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  mutate(species =  paste(Genus, Species)) %&gt;% \n  filter(!is.na(TypDrainEN)) %&gt;% \n  ggplot(aes(x = species, fill = as.factor(TypDrainEN))) +\n  geom_bar(position = \"dodge\") +\n  coord_flip() +\n  scale_fill_discrete(\"Drainage\")"
  },
  {
    "objectID": "1_env.html#correlations",
    "href": "1_env.html#correlations",
    "title": "1  Environment",
    "section": "Correlations",
    "text": "Correlations\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  mutate(TWI = log(TWI+1), HAND = log(HAND + 1)) %&gt;% \n  select(TWI, HAND, Hydro, LevelWater, TypeWatEN, TypDrainEN) %&gt;% \n  na.omit() %&gt;% \n  fastDummies::dummy_cols(c(\"Hydro\", \"LevelWater\", \"TypeWatEN\", \"TypDrainEN\"), remove_selected_columns = T) %&gt;% \n  cor() %&gt;% \n  corrplot::corrplot(type = \"lower\", method = \"number\", tl.cex = 0.8)"
  },
  {
    "objectID": "1_env.html#species-data",
    "href": "1_env.html#species-data",
    "title": "1  Environment",
    "section": "Species data",
    "text": "Species data\n\n\nCode\nvroom::vroom(\"data/paracou_env.tsv\") %&gt;% \n  group_by(Genus, Species) %&gt;% \n  summarise(TWI = mean(log(TWI+1), na.omit = T), \n            HAND = mean(log(HAND+1), na.omit = T)) %&gt;% \n  vroom::vroom_write(\"data/species_env\")\n\n\n\n\nCode\nvroom::vroom(\"data/species_env\") %&gt;% \n  kable(caption = \"Envrionmental descriptor per species.\")\n\n\n\nEnvrionmental descriptor per species.\n\n\nGenus\nSpecies\nTWI\nHAND\n\n\n\n\nBocoa\nprouacensis\n1.0074364\n2.534184\n\n\nChaetocarpus\nschomburgkianus\n1.0041621\n2.436889\n\n\nChrysophyllum\nsanguinolentum\n0.9747982\n2.349842\n\n\nDicorynia\nguianensis\n1.0407330\n2.322856\n\n\nEperua\nfalcata\n1.0413672\n1.961921\n\n\nEperua\ngrandiflora\n1.0209313\n2.494235\n\n\nEschweilera\nsagotiana\n1.0209671\n2.319500\n\n\nGoupia\nglabra\n1.0981859\n2.047156\n\n\nGustavia\nhexapetala\n1.0390552\n2.047410\n\n\nLecythis\npersistens subsp. aurantiaca\n1.0800652\n1.938543\n\n\nLecythis\npoiteaui\n1.0322048\n2.459923\n\n\nLicania\nmembranacea\n1.0151932\n2.361690\n\n\nManilkara\nbidentata\n1.0435142\n2.201363\n\n\nPradosia\ncochlearia\n1.0235659\n2.479418\n\n\nProtium\nopacum subsp. rabelianum\n1.1730619\n1.678871\n\n\nQualea\nrosea\n0.9806979\n2.368900\n\n\nSymphonia\nsp.1\n1.0073779\n2.301381\n\n\nTachigali\nmelinonii\n1.0869784\n2.099428\n\n\nVirola\nmichelii\n1.0273040\n2.403253"
  },
  {
    "objectID": "2_perf.html#growth",
    "href": "2_perf.html#growth",
    "title": "2  Performance",
    "section": "Growth",
    "text": "Growth\n\n\nCode\nparacou &lt;- vroom::vroom(\"data/paracou.tsv\") %&gt;% \n  filter(BotaSource == \"Bota\") %&gt;% \n  filter(!is.na(Xutm), !is.na(Yutm))\nparacouXY &lt;- paracou %&gt;% \n  st_as_sf(coords = c(\"Xutm\", \"Yutm\"),\n           crs = '+proj=utm +zone=22 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0')\nparacou &lt;- left_join(paracou,\n          st_intersection(readshp(\"data/TopographicLevels/TopographicLevels.shp\"), paracouXY) %&gt;% \n            st_drop_geometry() %&gt;% \n            select(idTree, TypeTopoEN))\nparacou %&gt;% \n  group_by(TypeTopoEN, Genus, Species, idTree) %&gt;% \n  arrange(CensusYear) %&gt;% \n  mutate(FirstDead = first(CensusYear[CodeAlive == 0])) %&gt;% \n  mutate(FirstDead = ifelse(is.na(FirstDead), max(CensusYear)+1, FirstDead)) %&gt;% \n  filter(CensusYear &lt; FirstDead) %&gt;% \n  summarise(AGR = (last(DBH) - first(DBH))/(last(CensusYear) - first(CensusYear))) %&gt;% \n  na.omit() %&gt;% \n  group_by(TypeTopoEN, Genus, Species) %&gt;% \n  summarise(AGR = median(AGR)) %&gt;% \n  pivot_wider(names_from = TypeTopoEN, values_from = AGR) %&gt;% \n  vroom::vroom_write(\"data/species_growth.tsv\")\n\n\n\n\nCode\nvroom::vroom(\"data/species_growth.tsv\") %&gt;% \n  kable(caption = \"Median of annual growth rate of all individuals across species (cm/year).\")  \n\n\n\nMedian of annual growth rate of all individuals across species (cm/year).\n\n\n\n\n\n\n\n\n\nGenus\nSpecies\nBottomland\nPlateau\nSlope\n\n\n\n\nBocoa\nprouacensis\n0.0568411\n0.0574726\n0.0530516\n\n\nChaetocarpus\nschomburgkianus\n0.0938177\n0.1070506\n0.0954930\n\n\nChrysophyllum\nsanguinolentum\n0.1830880\n0.1591549\n0.1591549\n\n\nDicorynia\nguianensis\n0.2273642\n0.2054699\n0.2410061\n\n\nEperua\nfalcata\n0.1406983\n0.1364185\n0.1256383\n\n\nEperua\ngrandiflora\n0.3239940\n0.2873631\n0.2864789\n\n\nEschweilera\nsagotiana\n0.1000402\n0.0839984\n0.0823215\n\n\nGoupia\nglabra\n0.2614688\n0.2699950\n0.2276800\n\n\nGustavia\nhexapetala\n0.0500201\n0.0454728\n0.0409256\n\n\nLecythis\npersistens subsp. aurantiaca\n0.0568411\n0.0284205\n0.0397887\n\n\nLecythis\npoiteaui\n0.0682093\n0.0384167\n0.0548810\n\n\nLicania\nmembranacea\n0.2055751\n0.2159960\n0.2077856\n\n\nManilkara\nbidentata\n0.2387324\n0.2097952\n0.2188968\n\n\nPradosia\ncochlearia\n0.1496814\n0.1177507\n0.1205365\n\n\nProtium\nopacum subsp. rabelianum\n0.2414765\n0.1591549\n0.2039962\n\n\nQualea\nrosea\n0.2924253\n0.3239940\n0.2635857\n\n\nSymphonia\nsp.1\n0.2864789\n0.2744051\n0.2696792\n\n\nTachigali\nmelinonii\n0.6479880\n0.7029343\n0.6495382\n\n\nVirola\nmichelii\n0.3154678\n0.3083627\n0.2723318\n\n\n\n\n\n\n\nCode\nvroom::vroom(\"data/species_growth.tsv\") %&gt;% \n  gather(habitat, AGR, -Genus, -Species, -Plateau) %&gt;% \n    ggplot(aes(Plateau, AGR, \n             label = paste0(str_sub(Genus, 1, 1), \". \", Species))) +\n  geom_smooth(method = \"lm\") +\n  geom_point() +\n  facet_wrap(~ habitat) +\n  ggpubr::stat_cor() +\n  xlab(\"AGR in Planteau\") +\n  ylab(\"AGR in other habitats\") +\n  ggrepel::geom_text_repel()"
  },
  {
    "objectID": "2_perf.html#mortality",
    "href": "2_perf.html#mortality",
    "title": "2  Performance",
    "section": "Mortality",
    "text": "Mortality\n\n\nCode\nparacou &lt;- vroom::vroom(\"data/paracou.tsv\") %&gt;% \n  filter(BotaSource == \"Bota\") %&gt;% \n  filter(!is.na(Xutm), !is.na(Yutm))\nparacouXY &lt;- paracou %&gt;% \n  st_as_sf(coords = c(\"Xutm\", \"Yutm\"),\n           crs = '+proj=utm +zone=22 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0')\nparacou &lt;- left_join(paracou,\n          st_intersection(readshp(\"data/TopographicLevels/TopographicLevels.shp\"), paracouXY) %&gt;% \n            st_drop_geometry() %&gt;% \n            select(idTree, TypeTopoEN))\nparacou %&gt;% \n  group_by(TypeTopoEN, Genus, Species, idTree) %&gt;% \n  summarise(death = ifelse(any(CodeAlive == 0), 1, 0),\n            y_min = min(CensusYear),\n            y_max = max(CensusYear)) %&gt;% \n  group_by(TypeTopoEN, Genus, Species) %&gt;% \n  summarise(mortality = sum(death) / n() / (max(y_max) - min(y_min)) * 100) %&gt;% \n  pivot_wider(names_from = TypeTopoEN, values_from = mortality) %&gt;% \n  vroom::vroom_write(\"data/species_mortality.tsv\")\n\n\n\n\nCode\nvroom::vroom(\"data/species_mortality.tsv\") %&gt;% \n  select(-\"NA\") %&gt;% \n  kable(caption = \"Annual mortality rate across species (%/year).\") \n\n\n\nAnnual mortality rate across species (%/year).\n\n\n\n\n\n\n\n\n\nGenus\nSpecies\nBottomland\nPlateau\nSlope\n\n\n\n\nBocoa\nprouacensis\n0.8140691\n0.7382382\n0.7415381\n\n\nChaetocarpus\nschomburgkianus\n0.3917379\n0.2777778\n0.3432003\n\n\nChrysophyllum\nsanguinolentum\n0.9166667\n1.0752688\n0.9856631\n\n\nDicorynia\nguianensis\n0.6195044\n0.5711319\n0.4542607\n\n\nEperua\nfalcata\n0.3594249\n0.1929970\n0.3066732\n\n\nEperua\ngrandiflora\n0.3822630\n0.3031793\n0.3621195\n\n\nEschweilera\nsagotiana\n0.2504554\n0.1814882\n0.2377101\n\n\nGoupia\nglabra\n0.6700168\n0.3968254\n0.5813953\n\n\nGustavia\nhexapetala\n0.4318123\n0.3614916\n0.3575871\n\n\nLecythis\npersistens subsp. aurantiaca\n0.2745478\n0.3235578\n0.2904270\n\n\nLecythis\npoiteaui\n0.2290951\n0.2469136\n0.2256063\n\n\nLicania\nmembranacea\n0.7103825\n0.3602305\n0.4481651\n\n\nManilkara\nbidentata\n0.7168459\n0.4137116\n0.6172840\n\n\nPradosia\ncochlearia\n0.3516174\n0.3437844\n0.3611642\n\n\nProtium\nopacum subsp. rabelianum\n0.5215420\n0.5658436\n0.5268199\n\n\nQualea\nrosea\n0.5911518\n0.4310345\n0.5545826\n\n\nSymphonia\nsp.1\n0.4103535\n0.3040354\n0.3803804\n\n\nTachigali\nmelinonii\n0.6038647\n0.3411306\n0.5477308\n\n\nVirola\nmichelii\n0.6410256\n0.5095332\n0.4759130\n\n\n\n\n\n\n\nCode\nvroom::vroom(\"data/species_mortality.tsv\") %&gt;% \n  select(-\"NA\") %&gt;% \n  gather(habitat, mortality, -Genus, -Species, -Plateau) %&gt;% \n  ggplot(aes(Plateau, mortality, \n             label = paste0(str_sub(Genus, 1, 1), \". \", Species))) +\n  geom_smooth(method = \"lm\") +\n  geom_point() +\n  facet_wrap(~ habitat) +\n  ggpubr::stat_cor() +\n  xlab(\"mortality in Planteau\") +\n  ylab(\"mortality in other habitats\") +\n  ggrepel::geom_text_repel()"
  },
  {
    "objectID": "2_perf.html#treefall",
    "href": "2_perf.html#treefall",
    "title": "2  Performance",
    "section": "Treefall",
    "text": "Treefall\n\n\nCode\nparacou &lt;- vroom::vroom(\"data/paracou.tsv\") %&gt;% \n  filter(BotaSource == \"Bota\") %&gt;% \n  filter(!is.na(Xutm), !is.na(Yutm))\nparacouXY &lt;- paracou %&gt;% \n  st_as_sf(coords = c(\"Xutm\", \"Yutm\"),\n           crs = '+proj=utm +zone=22 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0')\nparacou &lt;- left_join(paracou,\n          st_intersection(st_read(\"data/TopographicLevels/TopographicLevels.shp\"), paracouXY) %&gt;% \n            st_drop_geometry() %&gt;% \n            select(idTree, TypeTopoEN))\nparacou %&gt;% \n  group_by(TypeTopoEN, Genus, Species, idTree) %&gt;% \n  summarise(death = ifelse(any(MeasCode %in% 6:7), 1, 0),\n            y_min = min(CensusYear),\n            y_max = max(CensusYear)) %&gt;% \n  group_by(TypeTopoEN, Genus, Species) %&gt;% \n  summarise(mortality = sum(death) / n() / (max(y_max) - min(y_min)) * 100) %&gt;% \n  pivot_wider(names_from = TypeTopoEN, values_from = mortality) %&gt;% \n  vroom::vroom_write(\"data/species_treefall.tsv\")\n\n\n\n\nCode\nvroom::vroom(\"data/species_treefall.tsv\") %&gt;% \n  select(-\"NA\") %&gt;% \n  kable(caption = \"Annual treefall rate across species (%/year).\") \n\n\n\nAnnual treefall rate across species (%/year).\n\n\n\n\n\n\n\n\n\nGenus\nSpecies\nBottomland\nPlateau\nSlope\n\n\n\n\nBocoa\nprouacensis\n0.4598558\n0.4004004\n0.5426784\n\n\nChaetocarpus\nschomburgkianus\n0.3205128\n0.1923077\n0.3258845\n\n\nChrysophyllum\nsanguinolentum\n0.4444444\n0.5675030\n0.5847953\n\n\nDicorynia\nguianensis\n0.4396483\n0.2509519\n0.3241969\n\n\nEperua\nfalcata\n0.3461129\n0.1929970\n0.1837346\n\n\nEperua\ngrandiflora\n0.4077472\n0.1884628\n0.2680965\n\n\nEschweilera\nsagotiana\n0.2903005\n0.2192982\n0.2398217\n\n\nGoupia\nglabra\n0.3768844\n0.1831502\n0.2415459\n\n\nGustavia\nhexapetala\n0.3415829\n0.3614916\n0.3035823\n\n\nLecythis\npersistens subsp. aurantiaca\n0.3256891\n0.2443894\n0.3533859\n\n\nLecythis\npoiteaui\n0.4295533\n0.1851852\n0.2433090\n\n\nLicania\nmembranacea\n0.6284153\n0.2881844\n0.3488077\n\n\nManilkara\nbidentata\n0.2688172\n0.1773050\n0.3086420\n\n\nPradosia\ncochlearia\n0.3340366\n0.2681518\n0.3220612\n\n\nProtium\nopacum subsp. rabelianum\n0.5102041\n0.4115226\n0.3594771\n\n\nQualea\nrosea\n0.3877447\n0.2298851\n0.3242780\n\n\nSymphonia\nsp.1\n0.3051347\n0.2072968\n0.2629849\n\n\nTachigali\nmelinonii\n0.5314010\n0.0000000\n0.1984127\n\n\nVirola\nmichelii\n0.5827506\n0.3780408\n0.3036437\n\n\n\n\n\n\n\nCode\nvroom::vroom(\"data/species_treefall.tsv\") %&gt;% \n  select(-\"NA\") %&gt;% \n  gather(habitat, mortality, -Genus, -Species, -Plateau) %&gt;% \n  ggplot(aes(Plateau, mortality, \n             label = paste0(str_sub(Genus, 1, 1), \". \", Species))) +\n  geom_smooth(method = \"lm\") +\n  geom_point() +\n  facet_wrap(~ habitat) +\n  ggpubr::stat_cor() +\n  xlab(\"treefall in Planteau\") +\n  ylab(\"treefall in other habitats\") +\n  ggrepel::geom_text_repel()"
  },
  {
    "objectID": "2_perf.html#dead-standing",
    "href": "2_perf.html#dead-standing",
    "title": "2  Performance",
    "section": "Dead standing",
    "text": "Dead standing\n\n\nCode\nparacou &lt;- vroom::vroom(\"data/paracou.tsv\") %&gt;% \n  filter(BotaSource == \"Bota\") %&gt;% \n  filter(!is.na(Xutm), !is.na(Yutm))\nparacouXY &lt;- paracou %&gt;% \n  st_as_sf(coords = c(\"Xutm\", \"Yutm\"),\n           crs = '+proj=utm +zone=22 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0')\nparacou &lt;- left_join(paracou,\n          st_intersection(st_read(\"data/TopographicLevels/TopographicLevels.shp\"), paracouXY) %&gt;% \n            st_drop_geometry() %&gt;% \n            select(idTree, TypeTopoEN))\nparacou %&gt;% \n  group_by(TypeTopoEN, Genus, Species, idTree) %&gt;% \n  summarise(death = ifelse(any(MeasCode == 0 & CodeAlive == 0), 1, 0),\n            y_min = min(CensusYear),\n            y_max = max(CensusYear)) %&gt;% \n  group_by(TypeTopoEN, Genus, Species) %&gt;% \n  summarise(mortality = sum(death) / n() / (max(y_max) - min(y_min)) * 100) %&gt;% \n  pivot_wider(names_from = TypeTopoEN, values_from = mortality) %&gt;% \n  vroom::vroom_write(\"data/species_deadstanding.tsv\")\n\n\n\n\nCode\nvroom::vroom(\"data/species_deadstanding.tsv\") %&gt;% \n  select(-\"NA\") %&gt;% \n  kable(caption = \"Annual dead standing rate across species (%/year).\") \n\n\n\nAnnual dead standing rate across species (%/year).\n\n\n\n\n\n\n\n\n\nGenus\nSpecies\nBottomland\nPlateau\nSlope\n\n\n\n\nBocoa\nprouacensis\n0.2672135\n0.2669336\n0.2989330\n\n\nChaetocarpus\nschomburgkianus\n0.0712251\n0.1282051\n0.1707014\n\n\nChrysophyllum\nsanguinolentum\n0.2500000\n0.3584229\n0.2715121\n\n\nDicorynia\nguianensis\n0.0799361\n0.0865351\n0.0515768\n\n\nEperua\nfalcata\n0.1375577\n0.1309622\n0.1764820\n\n\nEperua\ngrandiflora\n0.0764526\n0.1638807\n0.1340483\n\n\nEschweilera\nsagotiana\n0.0967668\n0.1109095\n0.1208550\n\n\nGoupia\nglabra\n0.1395868\n0.0915751\n0.1509662\n\n\nGustavia\nhexapetala\n0.1869038\n0.1522070\n0.2125076\n\n\nLecythis\npersistens subsp. aurantiaca\n0.1305448\n0.2237367\n0.1183432\n\n\nLecythis\npoiteaui\n0.0859107\n0.1234568\n0.0811030\n\n\nLicania\nmembranacea\n0.1457195\n0.1120717\n0.1458650\n\n\nManilkara\nbidentata\n0.1792115\n0.1182033\n0.2469136\n\n\nPradosia\ncochlearia\n0.1054852\n0.2062706\n0.1288245\n\n\nProtium\nopacum subsp. rabelianum\n0.1133787\n0.2057613\n0.1960784\n\n\nQualea\nrosea\n0.2860412\n0.2586207\n0.2263828\n\n\nSymphonia\nsp.1\n0.1788721\n0.1796573\n0.1890204\n\n\nTachigali\nmelinonii\n0.2173913\n0.3411306\n0.3968254\n\n\nVirola\nmichelii\n0.0971251\n0.1808021\n0.2136752\n\n\n\n\n\n\n\nCode\nvroom::vroom(\"data/species_deadstanding.tsv\") %&gt;% \n  select(-\"NA\") %&gt;% \n  gather(habitat, mortality, -Genus, -Species, -Plateau) %&gt;% \n  ggplot(aes(Plateau, mortality, \n             label = paste0(str_sub(Genus, 1, 1), \". \", Species))) +\n  geom_smooth(method = \"lm\") +\n  geom_point() +\n  facet_wrap(~ habitat) +\n  ggpubr::stat_cor() +\n  xlab(\"dead standing in Planteau\") +\n  ylab(\"dead standing in other habitats\") +\n  ggrepel::geom_text_repel()"
  },
  {
    "objectID": "3_tests.html#figure-with-error",
    "href": "3_tests.html#figure-with-error",
    "title": "3  Tests",
    "section": "Figure with error",
    "text": "Figure with error\n\n\nCode\ndata &lt;- read_excel(\"data/camille/DATABASE_Canopy.xlsx\", \"All_data_Ind\") %&gt;% \n  separate(\"Species...1\", c(\"Genus\", \"Species\")) %&gt;% \n  mutate(SSMleaf = Ptlp_wet - P50leaf, \n         SSMstem = Ptlp_wet - P50stem) %&gt;% \n  select(Genus, Species, Ptlp_wet, P50leaf, P50stem,  SSMleaf, SSMstem, SegP50,\n         gmin_leaf, gmin_bark, `Al:As`, SegLSC_leaf, Pmd_18,\n         PLCleaf_18, PLCstem_18, Mortality) %&gt;% \n  rename(Ptlp = Ptlp_wet, gmin = gmin_leaf, gbark = gmin_bark,\n         SegLSC = SegLSC_leaf, Pmd = Pmd_18, PLCleaf = PLCleaf_18,\n         PLCstem = PLCstem_18, AlAs = `Al:As`) %&gt;% \n  gather(variable, value, -Genus, -Species) %&gt;% \n  group_by(Genus, Species, variable) %&gt;% \n  summarise(median = median(value, na.rm = T), sd  = sd(value, na.rm = T)) %&gt;% \n  mutate(sd = ifelse(is.na(sd), 0, sd)) %&gt;% \n  gather(metric, value, -Genus, -Species, -variable) %&gt;% \n  mutate(variable = paste0(variable, \"_\", metric)) %&gt;% \n  select(-metric) %&gt;% \n  pivot_wider(values_from = value, names_from = variable)\n\n\n\n\nCode\nggplot(data, aes(P50stem_median, P50leaf_median)) + \n  geom_smooth(method = lm, color = \"darkred\", fill = \"#000000\", se = T) +\n  geom_abline(linetype = \"dashed\", size = 0.8) +\n  geom_point(size = 4, color = \"black\") +\n  geom_errorbar(aes(ymin = P50leaf_median - P50leaf_sd, \n                    ymax = P50leaf_median + P50leaf_sd)) +\n  geom_errorbar(aes(xmin = P50stem_median - P50stem_sd, \n                    xmax = P50stem_median + P50stem_sd)) +\n  theme_bw() +\n  theme(panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank(),\n        text = element_text(size = 24), \n        axis.text=element_text(color = \"black\"), \n        legend.position = \"none\") +\n  scale_x_continuous(limits = c(-8.5,-1), breaks = seq(-8,-1,1)) +\n  scale_y_continuous(limits = c(-7,-1), breaks = seq(-5,-2,1)) +\n  ylab(expression(P[paste(50,\",\",leaf)]~(MPa))) + \n  xlab (expression(P[paste(50,\",\",stem)]~(MPa)))\n\n\n\n\n\n\n\nCode\nggplot(data, aes(P50stem_median, P50leaf_median)) + \n  geom_smooth(method = lm, color = \"darkred\", fill = \"#000000\", se = T) +\n  geom_abline(linetype = \"dashed\", size = 0.8) +\n  geom_point(size = 4, color = \"black\") +\n  geom_errorbar(aes(ymin = P50leaf_median - P50leaf_sd,\n                    ymax = P50leaf_median + P50leaf_sd,\n                    width = 0.2)) +\n  geom_errorbar(aes(xmin = P50stem_median - P50stem_sd,\n                    xmax = P50stem_median + P50stem_sd,\n                    width = 0.2)) +\n  theme_bw() +\n  theme(panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank(),\n        text = element_text(size = 24), \n        axis.text=element_text(color = \"black\"), \n        legend.position = \"none\") +\n  scale_x_continuous(limits = c(-8.5,-1), breaks = seq(-8,-1,1)) +\n  scale_y_continuous(limits = c(-7,-1), breaks = seq(-5,-2,1)) +\n  ylab(expression(P[paste(50,\",\",leaf)]~(MPa))) + \n  xlab (expression(P[paste(50,\",\",stem)]~(MPa)))"
  },
  {
    "objectID": "3_tests.html#old",
    "href": "3_tests.html#old",
    "title": "3  Tests",
    "section": "Old",
    "text": "Old\n\nData\n\n\nCode\nind &lt;- readxl::read_excel(\"data/camille/DATABASE_Canopy.xlsx\", \"All_data_Ind\") %&gt;% \n  separate(\"Species...1\", c(\"Genus\", \"Species\")) %&gt;% \n  filter(!is.na(XUTM)) %&gt;% \n  mutate(SSMleaf = Ptlp_wet - P50leaf, \n         SSMstem = Ptlp_wet - P50stem) %&gt;% \n  select(Genus, Species, Ptlp_wet, P50leaf, P50stem,  SSMleaf, SSMstem, SegP50,\n         gmin_leaf, gmin_bark, `Al:As`, SegLSC_leaf, Pmd_18,\n         PLCleaf_18, PLCstem_18, Mortality) %&gt;% \n  rename(Ptlp = Ptlp_wet, gmin = gmin_leaf, gbark = gmin_bark,\n         SegLSC = SegLSC_leaf, Pmd = Pmd_18, PLCleaf = PLCleaf_18,\n         PLCstem = PLCstem_18)\nindxy &lt;- readxl::read_excel(\"data/camille/DATABASE_Canopy.xlsx\", \"All_data_Ind\") %&gt;% \n  filter(!is.na(XUTM)) %&gt;% \n  st_as_sf(coords = c(\"XUTM\", \"YUTM\"),\n           crs = '+proj=utm +zone=22 +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0')\nind$HAND &lt;- raster::extract(raster::raster(\"data/RelativeElevation_1m.tif\"), indxy)\nrm(indxy)\nagr &lt;- readxl::read_excel(\"data/camille/DATABASE_Canopy.xlsx\", \"All_data_Ind\") %&gt;% \n  filter(!is.na(XUTM)) %&gt;% \n  select(\"Species...1\") %&gt;% \n  separate(\"Species...1\", c(\"Genus\", \"Species\")) %&gt;% \n  left_join(vroom(\"data/species_growth.tsv\"))\nind$AGR &lt;- agr$Plateau\n\n\n\n\nNormality\n\n\nCode\nind %&gt;% \n  gather(variable, value, -Genus, -Species) %&gt;% \n  na.omit() %&gt;% \n  ggplot(aes(value)) +\n  geom_histogram() +\n  facet_wrap(~ variable, scales = \"free\") +\n  ggtitle(\"Distribution raw\")\n\n\n\n\n\n\n\nCode\nind %&gt;% \n  gather(variable, value, -Genus, -Species) %&gt;% \n  na.omit() %&gt;% \n  ggplot(aes(log(abs(value)))) +\n  geom_histogram() +\n  facet_wrap(~ variable, scales = \"free\") +\n  ggtitle(\"Distribution log and abs transformed\")\n\n\n\n\n\n\n\nFigure 1\n\n\nCode\nm1 &lt;- lm(P50stem ~ P50leaf, ind)\nm2 &lt;- lm(gbark ~ gmin, ind)\nm3 &lt;- lm(gbark ~ P50stem, ind)\nm4 &lt;- lm(gmin ~ P50leaf, ind)\nsjPlot::tab_model(m1, m2, m3, m4)\n\n\n\n\n\n \nP 50 stem\ngbark\ngbark\ngmin\n\n\nPredictors\nEstimates\nCI\np\nEstimates\nCI\np\nEstimates\nCI\np\nEstimates\nCI\np\n\n\n(Intercept)\n-1.67\n-3.05 – -0.29\n0.019\n3.69\n2.41 – 4.97\n&lt;0.001\n5.59\n4.04 – 7.14\n&lt;0.001\n6.90\n4.15 – 9.66\n&lt;0.001\n\n\nP50leaf\n0.69\n0.30 – 1.08\n0.001\n\n\n\n\n\n\n0.56\n-0.23 – 1.34\n0.161\n\n\ngmin\n\n\n\n0.22\n-0.03 – 0.47\n0.089\n\n\n\n\n\n\n\n\nP50stem\n\n\n\n\n\n\n0.23\n-0.12 – 0.58\n0.187\n\n\n\n\n\nObservations\n53\n37\n37\n51\n\n\nR2 / R2 adjusted\n0.201 / 0.185\n0.080 / 0.054\n0.049 / 0.022\n0.040 / 0.020\n\n\n\n\n\n\n\n\n\nCode\ng1 &lt;- ggplot(ind, aes(P50stem, P50leaf)) +\n  geom_smooth(method = \"lm\", formula = y ~ x, col = \"red\") +\n  geom_abline(linetype = \"dashed\") +\n  geom_point() +\n  xlab(expression(P[50~stem]~(MPa))) +\n  ylab(expression(P[50~leaf]~(MPa))) +\n  ggtitle(paste0(\"R²=\", round(broom::glance(m1)$r.squared, 3),\n          \", p=\", round(broom::glance(m1)$p.value, 3)))\ng2 &lt;- ggplot(ind, aes(gbark, gmin)) +\n  geom_abline(linetype = \"dashed\") +\n  geom_point() +\n  ylab(expression(g[min]~(mmol~m^{-2}~s^{-1}))) + ylim(0, 10) +\n  xlab(expression(g[bark]~(mmol~m^{-2}~s^{-1}))) +\n  ggtitle(paste0(\"R²=\", round(broom::glance(m2)$r.squared, 3),\n          \", p=\", round(broom::glance(m2)$p.value, 3)))\ng3 &lt;- ggplot(ind, aes(P50stem, gbark)) +\n  geom_point() +\n  xlab(expression(P[50~stem]~(MPa))) +\n  ylab(expression(g[bark]~(mmol~m^{-2}~s^{-1}))) +\n  ggtitle(paste0(\"R²=\", round(broom::glance(m3)$r.squared, 3),\n          \", p=\", round(broom::glance(m3)$p.value, 3)))\ng4 &lt;- ggplot(ind, aes(P50leaf, gmin)) +\n  geom_point() +\n  ylab(expression(g[min]~(mmol~m^{-2}~s^{-1}))) + ylim(0, 10) +\n  xlab(expression(P[50~leaf]~(MPa))) +\n  ggtitle(paste0(\"R²=\", round(broom::glance(m4)$r.squared, 3),\n          \", p=\", round(broom::glance(m4)$p.value, 3)))\n(g1 + g2) / (g3 + g4)\n\n\n\n\n\n\n\nFigure 2\n\n\nCode\ng1 &lt;- ind %&gt;% \n  select(SSMleaf, SSMstem, SegP50) %&gt;% \n  gather(variable, value, -SegP50) %&gt;% \n  na.omit() %&gt;% \n  ggplot(aes(SegP50, value, col = variable)) +\n  geom_smooth(method = \"lm\") +\n  geom_point() +\n  scale_color_manual(guide = \"none\", values = c(\"darkgreen\", \"orange\")) +\n  ggpubr::stat_cor(aes(label =  paste(..p.label..)), label.y.npc = 0.7) +\n  ggpubr::stat_regline_equation(aes(label =  paste(..adj.rr.label..))) +\n  xlab(expression(Seg[P50]~(MPa))) +\n  ylab(expression(SSM[leaf]~or~SSM[stem]~(MPa)))\ng2 &lt;- ggplot(ind, aes(SegLSC, gmin)) +\n  geom_point() +\n  ggpubr::stat_cor(aes(label =  paste(..p.label..)), label.y.npc = 0.8) +\n  ggpubr::stat_regline_equation(aes(label =  paste(..adj.rr.label..))) +\n  ylab(expression(g[min]~(mmol~m^{-2}~s^{-1}))) + ylim(0, 10) +\n  xlab(expression(Seg[LSC]~(10^{5}~kg~m^{-1}~Mpa^{-1}~s^{-1})))\ng3 &lt;- ind %&gt;% \n  select(gmin, gbark, `Al:As`) %&gt;% \n  gather(variable, value, -`Al:As`) %&gt;% \n  na.omit() %&gt;% \n  ggplot(aes(value, `Al:As`, col = variable)) +\n  geom_smooth(method = \"lm\") +\n  geom_point() +\n  scale_color_manual(guide = \"none\", values = c(\"darkgreen\", \"orange\")) +\n  ggpubr::stat_cor(aes(label =  paste(..p.label..)), label.y.npc = 0.7) +\n  ggpubr::stat_regline_equation(aes(label =  paste(..adj.rr.label..))) +\n  ylab(\"Al:As\") +\n  xlab(expression(g[min]~or~g[bark]~(mmol~m^{-2}~s^{-1})))\ng4 &lt;- ind %&gt;% \n  select(P50leaf, P50stem, `Al:As`) %&gt;% \n  gather(variable, value, -`Al:As`) %&gt;% \n  na.omit() %&gt;% \n  ggplot(aes(value, `Al:As`, col = variable)) +\n  geom_point() +\n  scale_color_manual(guide = \"none\", values = c(\"darkgreen\", \"orange\")) +\n  ggpubr::stat_cor(aes(label =  paste(..p.label..)), label.y.npc = 0.7) +\n  ggpubr::stat_regline_equation(aes(label =  paste(..adj.rr.label..))) +\n  ylab(\"Al:As\") +\n  xlab(expression(P[50~leaf]~or~P[50~stem]~(MPa)))\n(g1 + g2) / (g3 + g4)\n\n\n\n\n\n\n\nFigure 3\n\n\nCode\ndata &lt;- select(ind, PLCstem, P50stem, \n               SSMstem, SegP50) %&gt;% \n  na.omit()\nm0 &lt;- lm(log(PLCstem) ~ P50stem, data)\nm1 &lt;- lm(log(PLCstem) ~ SSMstem, data)\nm2 &lt;- lm(log(PLCstem) ~ SegP50, data)\nanova(m0, m1, m2)\n\n\nAnalysis of Variance Table\n\nModel 1: log(PLCstem) ~ P50stem\nModel 2: log(PLCstem) ~ SSMstem\nModel 3: log(PLCstem) ~ SegP50\n  Res.Df    RSS Df Sum of Sq F Pr(&gt;F)\n1     41 3151.0                      \n2     41 3101.8  0     49.22         \n3     41 3485.7  0   -383.89         \n\n\n\n\nFigure 5\n\n\nCode\ndata &lt;- ind %&gt;% \n  rename(AlAs = `Al:As`) %&gt;% \n  select(HAND, Ptlp, P50leaf, P50stem, gmin, gbark, AlAs) %&gt;% \n  na.omit()\nlm(HAND ~ Ptlp + P50leaf + P50stem + log(gmin) + log(gbark) + log(AlAs), data) %&gt;% \n  step(trace = F) %&gt;% \n  sjPlot::tab_model()\n\n\n\n\n\n \nHAND\n\n\nPredictors\nEstimates\nCI\np\n\n\n(Intercept)\n15.09\n13.13 – 17.06\n&lt;0.001\n\n\nObservations\n27\n\n\nR2 / R2 adjusted\n0.000 / 0.000\n\n\n\n\n\n\n\n\n\nCode\ndatag &lt;- data %&gt;% \n  mutate(gmin = log(gmin), gbark = log(gbark), AlAs = log(AlAs)) %&gt;% \n  gather(variable, value, -HAND) %&gt;% \n  na.omit() %&gt;% \n  mutate(variable_long = recode(variable,\n                                \"AlAs\" = \"log(Al:As)\",\n                                \"Ptlp\" = \"P[tlp]~(MPa)\",\n                                \"P50leaf\" = \"P[50~leaf]~(MPa)\",\n                                \"P50stem\" = \"P[50~stem]~(MPa)\",\n                                \"gmin\" = \"log(g[min])~(mmol~m^{-2}~s^{-1})\",\n                                \"gbark\" = \"log(g[bark])~(mmol~m^{-2}~s^{-1})\"\n  ))\nggplot(datag, aes(HAND, value)) +\n  geom_point() +\n  facet_wrap(~ variable_long, scales = \"free\", labeller = label_parsed) +\n  ylab(\"\") + xlab(\"HAND (m)\")\n\n\n\n\n\n\n\nFigure 6\n\n\nCode\ndata &lt;- ind %&gt;% \n  rename(AlAs = `Al:As`) %&gt;% \n  select(Mortality, Ptlp, P50leaf, P50stem, gmin, gbark, AlAs) %&gt;% \n  na.omit()\nlm(Mortality ~ Ptlp + P50leaf + P50stem + log(gmin) + log(gbark) + log(AlAs), data) %&gt;% \n  step(trace = F) %&gt;% \n  sjPlot::tab_model()\n\n\n\n\n\n \nMortality\n\n\nPredictors\nEstimates\nCI\np\n\n\n(Intercept)\n-0.13\n-0.53 – 0.28\n0.520\n\n\nP50leaf\n-0.05\n-0.11 – 0.01\n0.109\n\n\ngmin [log]\n0.09\n-0.03 – 0.21\n0.136\n\n\ngbark [log]\n0.27\n0.04 – 0.51\n0.025\n\n\nObservations\n25\n\n\nR2 / R2 adjusted\n0.423 / 0.340\n\n\n\n\n\n\n\n\n\nCode\ndatag &lt;- data %&gt;% \n  mutate(gmin = log(gmin), gbark = log(gbark), AlAs = log(AlAs)) %&gt;% \n  gather(variable, value, -Mortality) %&gt;% \n  na.omit() %&gt;% \n  mutate(variable_long = recode(variable,\n                                \"AlAs\" = \"log(Al:As)\",\n                                \"Ptlp\" = \"P[tlp]~(MPa)\",\n                                \"P50leaf\" = \"P[50~leaf]~(MPa)\",\n                                \"P50stem\" = \"P[50~stem]~(MPa)\",\n                                \"gmin\" = \"log(g[min])~(mmol~m^{-2}~s^{-1})\",\n                                \"gbark\" = \"log(g[bark])~(mmol~m^{-2}~s^{-1})\"\n  ))\nggplot(datag, aes(value, Mortality)) +\n  geom_point() +\n  facet_wrap(~ variable_long, scales = \"free\", labeller = label_parsed) +\n  ylab(expression(Mortality~(\"%\"~year^{-1}))) + xlab(\"\") +\n   geom_smooth(method = \"lm\", data = filter(datag, variable %in% c(\"gbark\")))\n\n\n\n\n\n\n\nCode\nm1 &lt;- lm(Mortality ~ log(gbark), ind)\nsjPlot::tab_model(m1)\n\n\n\n\n\n \nMortality\n\n\nPredictors\nEstimates\nCI\np\n\n\n(Intercept)\n0.23\n-0.04 – 0.50\n0.088\n\n\ngbark [log]\n0.25\n0.07 – 0.43\n0.007\n\n\nObservations\n36\n\n\nR2 / R2 adjusted\n0.194 / 0.170\n\n\n\n\n\n\n\n\n\nCode\nggplot(data, aes(Mortality, gbark)) +\n  geom_smooth(method = \"lm\", formula = y ~ log(x), col = \"red\") +\n  geom_point() +\n  ylab(expression(Mortality~(\"%\"~year^{-1}))) +\n  xlab(expression(g[bark]~(mmol~m^{-2}~s^{-1}))) +\n  ggtitle(paste0(\"R²=\", round(broom::glance(m1)$r.squared, 3),\n          \", p=\", round(broom::glance(m1)$p.value, 3)))\n\n\n\n\n\n\n\nFigure 7\n\n\nCode\ndata &lt;- ind %&gt;% \n  rename(AlAs = `Al:As`) %&gt;% \n  select(AGR, Ptlp, P50leaf, P50stem, gmin, gbark, AlAs) %&gt;% \n  na.omit()\nlm(log(AGR) ~ Ptlp + P50leaf + P50stem + log(gmin) + log(gbark) + log(AlAs), data) %&gt;% \n  step(trace = F) %&gt;% \n  sjPlot::tab_model()\n\n\n\n\n\n \nlog(AGR)\n\n\nPredictors\nEstimates\nCI\np\n\n\n(Intercept)\n-1.90\n-3.60 – -0.19\n0.031\n\n\nP50stem\n-0.22\n-0.42 – -0.03\n0.026\n\n\ngmin [log]\n0.94\n0.31 – 1.56\n0.006\n\n\ngbark [log]\n-1.58\n-2.76 – -0.40\n0.012\n\n\nObservations\n22\n\n\nR2 / R2 adjusted\n0.439 / 0.346\n\n\n\n\n\n\n\n\n\nCode\ndatag &lt;- data %&gt;% \n  mutate(gmin = log(gmin), gbark = log(gbark), AlAs = log(AlAs)) %&gt;% \n  gather(variable, value, -AGR) %&gt;% \n  na.omit() %&gt;% \n  mutate(variable_long = recode(variable,\n                                \"AlAs\" = \"log(Al:As)\",\n                                \"Ptlp\" = \"P[tlp]~(MPa)\",\n                                \"P50leaf\" = \"P[50~leaf]~(MPa)\",\n                                \"P50stem\" = \"P[50~stem]~(MPa)\",\n                                \"gmin\" = \"log(g[min])~(mmol~m^{-2}~s^{-1})\",\n                                \"gbark\" = \"log(g[bark])~(mmol~m^{-2}~s^{-1})\"\n  ))\nggplot(datag, aes(value, AGR)) +\n  geom_point() +\n  facet_wrap(~ variable_long, scales = \"free\", labeller = label_parsed) +\n  ylab(expression(Annual~growth~rate~(\"cm\"~year^{-1}))) + xlab(\"\") +\n  scale_y_log10() +\n  geom_smooth(method = \"lm\", data = filter(datag, variable %in% c(\"gbark\", \"gmin\", \"P50stem\")))\n\n\n\n\n\n\n\nCode\ndatag2 &lt;- select(data, gbark, gmin, P50stem, AGR) %&gt;% \n  gather(variable, value, -AGR) %&gt;% \n  na.omit() %&gt;% \n  mutate(variable_long = recode(variable,\n                                \"P50stem\" = \"P[50~stem]~(MPa)~~p==0.043\",\n                                \"gmin\" = \"log(g[min])~(mmol~m^{-2}~s^{-1})~~p==0.006\",\n                                \"gbark\" = \"log(g[bark])~(mmol~m^{-2}~s^{-1})~~p==0.003\"\n  ))\n\nggplot(datag2, aes(value, AGR)) +\n  geom_point() +\n  scale_y_log10() +\n  ylab(expression(Annual~growth~rate~(\"cm\"~year^{-1}))) + xlab(\"\") +\n  ggtitle(\"log(AGR) ~ P50 + log(gmin) + log(gbark)\", \"N=22, R²=0.467\") +\n  facet_wrap(~ variable_long, scales = \"free\", labeller = label_parsed) +\n  geom_smooth(method = \"lm\", formula = y ~ log(x), col = \"red\",\n              data = filter(datag2, variable %in% c(\"gmin\", \"gbark\"))) +\n  geom_smooth(method = \"lm\", formula = y ~ x, col = \"red\",\n              data = filter(datag2, variable %in% c(\"P50stem\")))\n\n\n\n\nFigure S2\n\n\nCode\nind %&gt;% \n  select(-Genus, -Species) %&gt;% \n  cor(use = \"pairwise.complete.obs\") %&gt;% \n  corrplot::corrplot(type = \"upper\",\n                     method = \"ellipse\",\n                     col = colorRampPalette(c(\"blue\", \"white\",\"red\"))(100))\n\n\n\n\n\n\n\nFigure S4\n\n\nCode\nind %&gt;% \n  select(Genus, Species, HAND) %&gt;% \n  group_by(Genus, Species) %&gt;% \n  mutate(Hmed = median(HAND)) %&gt;% \n  arrange(Hmed) %&gt;% \n  mutate(type = \"Terra firme\") %&gt;% \n  mutate(type = ifelse(Species %in% c(\"bidentata\", \"rosea\", \"globulifera\", \"melinonii\"), \n                       \"Generalist\", type)) %&gt;% \n  mutate(type = ifelse(Species %in% c(\"falcata\", \"glabra\", \"hexapetala\", \"persistens\",\n                                      \"opacum\"),\n                       \"Bottomland\", type)) %&gt;%\n  ggplot(aes(reorder(paste(Genus, Species), Hmed), HAND, col = type)) +\n  geom_boxplot() +\n  coord_flip() +\n  xlab(\"\") + ylab(\"HAND (m)\") +\n  theme(axis.text.y = element_text(face = \"italic\")) +\n  scale_color_manual(guide = \"none\", values = c(\"green\", \"orange\", \"firebrick\"))\n\n\n\n\n\n\n\nACP\n\n\nCode\nlibrary(\"FactoMineR\")\nlibrary(\"factoextra\")\nlibrary(NbClust)\nlibrary(tidyverse)\nlibrary(RColorBrewer)\nlibrary(ggsci)\n\nTab &lt;- read.csv(\"data/ACP_canopy_strategy_traits_gapfill_19sp.csv\",\n                header = T, sep = \";\", na.strings = \"NA\")\n\n#enlever les colonnes en trop\nTab$X&lt;-NULL\nTab$X.1&lt;-NULL\n# dim(Tab)\n\n#PCA traits without supplementary quantitative variables\n#Tab 3 only has active traits (without supp quanti)\nTab3&lt;-Tab[1:20,1:33]\n# dim(Tab3)\n# head(Tab3[, 1:33], 50) #Pour loader seulement les colonnes intéressantes\nTab3&lt;-subset(Tab,select=c(Species, SSMleaf, SSMstem, SegP50,\n                          Ptlp, P50stem, P50leaf, gmin, gbark, Al.As, SegLSC))\nTab3&lt;-na.omit(Tab3)\nrownames(Tab3)&lt;-Tab3$Species\nTab4 &lt;- Tab3[ , - c(1)]\nnames(Tab4) &lt;- c(\"SSM[leaf]\",\n                 \"SSM[stem]\",\n                 \"Seg[Psi(50)]\",\n                 \"pi[tlp]\",\n                 'italic(Psi)[paste(50,\",\",stem)]',\n                 'italic(Psi)[paste(50,\",\",leaf)]',\n                 \"italic(g)[min]\",\n                 \"italic(g)[bark]\",\n                 'paste(A[l],\":\",A[s])',\n                 \"Seg[LSC]\" )\nres.pca &lt;- PCA(Tab4, quanti.sup = 1:3, graph = FALSE)\ng &lt;- fviz_pca_var(res.pca, col.var = \"contrib\", axes = c(1,2), parse = TRUE,\n                  gradient.cols = c(\"#FFCC00\",\"#990099\", \"#CC0033\"),\n                  arrowsize = 1, labelsize = 6, \n                  axes.linetype = \"dashed\", \n                  pointsize = 3, repel = T,\n                  col.ind = \"black\", title = \"\",\n                  col.quanti.sup = \"#6666FF\",\n                  invisible = \"none\",\n                  axis.text=element_text(size=16),\n                  ggtheme=theme(axis.text=element_text(size=22), \n                                axis.title=element_text(size=22),\n                                legend.title = element_text(size = 14),\n                                legend.text = element_text(size = 14),\n                                panel.background = element_rect(fill = \"white\", colour = \"black\",\n                                                                size = 1, linetype = \"solid\"),\n                                panel.grid.major = element_line(size = 0.5, linetype = 'solid',\n                                                                colour = \"white\"),\n                                panel.grid.minor = element_line(size = 0.25, linetype = 'solid',\n                                                                colour = \"white\")))\n\ng$layers[[5]]$geom_params$parse &lt;- TRUE\ng"
  }
]